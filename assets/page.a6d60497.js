import{j as B,h as D}from"./index.79ccf8fe.js";function o(n){return function(t){const u=[];for(const r of t)u.push(n(r));return u}}function a(n){return n.reduce((t,u)=>(Array.isArray(u)?t.push(...a(u)):t.push(u),t),[])}function e(n){function t(r){return e(r(n))}function u(){return n}return{pipe:t,unwrap:u}}function p(n){return function(t){return t[n]}}function d(n){return function(t){return function(u){for(const r of u)t=n(t,r);return t}}}function $(n){return n!=null}function h(n){function t(r){const i=$(n)?r(n):n;return h(i)}function u(){return n}return{pipe:t,unwrap:u}}const F=n=>t=>t(n),T=n=>t=>t.includes(n);function s(n){return function(t){const u=[];for(const r of t)n(r)&&u.push(r);return u}}function j(n){return function(t){const u=[];let r=0;for(;r<t.length;)u.push(t.slice(r,r+n)),r+=n;return u}}function y(n){return new Intl.NumberFormat("us",{minimumFractionDigits:2}).format(n)}const k=n=>n.length,C=n=>t=>t>=n,w=d((n,t)=>n+t),E=n=>t=>t.join(n);function N(n){return`- ${n.name}     $${y(n.price)}`}function P(n){return`- \u7B26\u5408\u6298\u6263[${n.rule}],\u6298\u62B5${n.amount}\u5143`}const A=({discounts:n})=>h(n).pipe(o(P)).unwrap()||[],R=n=>e(n).pipe(p("products")).pipe(o(N)).unwrap(),I=n=>`Total: $${y(n.total)}`;function Q(n,t){const u=t.check(n.products);if(!u)return n;const r=n.total-u.amount,i=n.discounts?[...n.discounts,u]:[u];return{...n,total:r,discounts:i}}function q(n){return function(t){return d(Q)(t)(n)}}const v=n=>t=>e(a([o(F(t))(n)])).pipe(E(`
`)).unwrap();function x(n){const t=e(n).pipe(o(p("price"))).pipe(w(0)).unwrap();return{products:n,total:t}}const z=n=>t=>e(t).pipe(p("tags")).pipe(T(n)).unwrap();function G({name:n,count:t,rate:u,applyTag:r}){function i(f){const l=z(r);if(!e(f).pipe(s(l)).pipe(k).pipe(C(t)).unwrap())return;const m=e(f).pipe(s(l)).pipe(j(t)).pipe(s(c=>c.length>=t)).pipe(a).unwrap(),g=e(m).pipe(o(p("price"))).pipe(o(c=>c*u)).pipe(w(0)).unwrap();return{rule:n,products:m,amount:g}}return{name:n,check:i}}function K(n){return e(n).pipe(x).pipe(q([G({name:"\u4EFB2\u7BB1\u7D50\u5E3388\u6298",count:2,rate:.12,applyTag:"\u71B1\u92B7\u98F2\u54C1"})])).pipe(v([R,A,I])).unwrap()}const L=()=>B(D,{children:"npm run test"});export{x as checkout,L as default,v as display,A as displayDiscounts,R as displayProducts,I as displayTotal,K as main};
