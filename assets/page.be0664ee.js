import{C as q,M as z,d as H,g as W}from"./store_list.40a441b8.js";import{r as E,j as t,h as k,T as F,V as U,u as j,W as S,a as C,X as A,Y as V,Z as X,$ as Z,a0 as G,D as J,v as T,a1 as P,a2 as L,o as ee,a3 as O,a4 as te,a5 as B,a6 as _,a7 as ne,a8 as ue}from"./index.79ccf8fe.js";import{E as h,u as ae}from"./AntdProvider.2e15f5eb.js";import{u as oe}from"./useHook.2165d04e.js";import"./index.0dcafd45.js";const se=({data:n=[],handleExport:o})=>{const[u,s]=E.exports.useState(!1);function i(){s(!0);const a=F.book_new(),e=F.json_to_sheet(n);F.book_append_sheet(a,e,"excel"),U(a,"Excel.xlsx"),s(!1)}return t(k,{children:t(h,{className:"bg-green-800 hover:!bg-green-700",type:"primary",onClick:o||i,loading:u,children:"\u4E0B\u8F09Excel"})})},ie=({data:n,columns:o,templateTableProps:u,onPaginate:s,onSort:i,onFilter:r,onSelect:a,onExport:e,onSearch:d,searchLayoutArray:l,...m})=>{const p=(u==null?void 0:u.width)||60,I=(u==null?void 0:u.align)||"center",{windowHeight:M}=oe(),K=j(),[y]=S.useForm(),Y=(c,g,f,D)=>{const{action:x}=D,v=new Map([["paginate",()=>s&&s(c)],["sort",()=>i&&i(f)],["filter",()=>r&&r(g)]]).get(x)||(()=>console.log("no action"));v==null||v.call(void 0)},Q=()=>{K("create")},b=o.map(c=>({key:c.key?c.key:c.dataIndex?c.dataIndex:c.title,align:I,width:p,...c})),R=b.reduce((c,g)=>(c+=g.width,c),0),$=()=>{y.resetFields()};return t(q,{children:C(z,{children:[l&&(l==null?void 0:l.length)!==0&&t(S,{className:"mb-3",layout:"vertical",form:y,onFinish:d,children:C("div",{className:"relative grid gap-x-3",children:[l==null?void 0:l.map(({label:c,name:g,content:f,className:D,rules:x,...N})=>t(S.Item,{className:D,label:c,name:g,rules:x,...N,children:f||t(A,{placeholder:`\u8ACB\u8F38\u5165${c}`})},g)),C("div",{className:" col-span-4 flex items-center justify-end gap-2  ",children:[t(h,{onClick:$,danger:!0,children:"\u6E05\u9664"}),t(h,{htmlType:"submit",children:"\u67E5\u8A62"})]})]})}),C("div",{className:" flex justify-end gap-2 ",children:[t(se,{handleExport:e,data:n}),t(h,{onClick:Q,children:"\u65B0\u589E"})]}),t(V,{size:"small",onChange:Y,scroll:{x:R,y:M-200},columns:b,dataSource:le(n),pagination:{position:["bottomCenter"]},rowSelection:a?{type:"checkbox",onChange:(c,g)=>{a(g)}}:void 0,...m})]})})};function le(n,o){let u=1;return s(n,o||"");function s(i,r){if(Array.isArray(i))return i.map(a=>s(a,r));if(typeof i=="object"&&i!==null){const a={...i};return a.key=a[r]!==void 0?String(a[r]):String(u++),a.children&&(a.children=s(a.children,r).map(e=>(e.key=`${a.key}-${e.key}`,e))),a}else return i}}function re(n){const[o,u]=E.exports.useState(n),[s,i]=X(),r=E.exports.useMemo(()=>{const a={};for(const[e,d]of s)a[e]=d;return a},[s]);return E.exports.useEffect(()=>{u(r)},[]),Z(()=>{i(o)},[o]),[o,u]}const ce=({children:n,content:o})=>{const u=[{key:G(),label:t("div",{className:"flex flex-col gap-1",children:n})}];return t(k,{children:t(J,{menu:{items:u},placement:"bottom",children:o||t(T,{children:"\u64CD\u4F5C"})})})},de=()=>{const{modal:n,message:o}=ae(),u=j(),s=P(),{mutate:i}=L({mutationFn:H,onSuccess:()=>{o.success("\u522A\u9664\u6210\u529F"),s.invalidateQueries(["store_list"])},onError:e=>{o==null||o.error("\u522A\u9664\u5931\u6557!!"+(e==null?void 0:e.message)||"")}}),r=e=>{u(e)},a=e=>{n==null||n.confirm({title:t("div",{children:"\u64CD\u4F5C\u6709\u5371\u96AA"}),icon:t(te,{}),content:"\u522A\u9664\u8CC7\u6599\u4E0D\u53EF\u56DE\u5FA9\uFF0C\u78BA\u8A8D\u522A\u9664?",okText:"\u78BA\u8A8D",cancelText:"\u53D6\u6D88",onOk:()=>{i(e.id)}})};return[{title:"id",dataIndex:"id"},{title:"\u6848\u4EF6\u7DE8\u865F",render:e=>t(ee,{to:e.id,children:e.caseNo})},{title:"\u7279\u5E97\u7DE8\u865F",width:140,dataIndex:"specialStoreNo",filterDropdown:ge,filterIcon:me},{title:"\u7279\u5E97\u540D\u7A31",dataIndex:"specialStoreName"},{title:"\u7D71\u4E00\u7DE8\u865F",dataIndex:"uniformNo",width:140},{title:"\u62DB\u652C\u55AE\u4F4D",dataIndex:"solicitationUnit"},{title:"\u72C0\u614B",render:e=>t("div",{children:e.status==="normal"?"\u6B63\u5E38":"\u7570\u5E38"})},{title:"\u64CD\u4F5C",fixed:"right",width:90,key:"operation",render:e=>C(ce,{children:[t(h,{onClick:()=>{r(e.id)},children:"\u7DE8\u8F2F"}),t(h,{onClick:()=>{a(e)},type:"primary",danger:!0,disabled:!1,children:"\u522A\u9664"})]})}]},me=n=>t(O,{style:{color:n?"#1677ff":void 0}}),ge=n=>{const{selectedKeys:o,setSelectedKeys:u,confirm:s,clearFilters:i}=n,r=()=>{i==null||i(),s({closeDropdown:!0})};return C("div",{className:"p-2",children:[t(A,{onChange:a=>u(a.target.value?[a.target.value]:[]),onPressEnter:()=>s(),value:o[0]}),C("div",{className:"mt-2 flex justify-around gap-2",children:[t(h,{type:"primary",icon:t(O,{}),onClick:()=>s(),children:"\u641C\u5C0B"}),t(h,{onClick:r,children:"\u91CD\u7F6E"}),t(h,{danger:!0,onClick:()=>s({closeDropdown:!0}),children:"\u53D6\u6D88"})]})]})},{RangePicker:he}=ne,w="YYYY\u5E74MM\u6708DD\u65E5",Ce=()=>[{label:"\u6848\u4EF6\u7DE8\u865F",name:"caseNo",content:t(B,{placeholder:"\u9078\u64C7\u6848\u4EF6\u7DE8\u865F",options:[{value:"S_1734452021",label:"S_1734452021"},{value:"S_3472126016",label:"S_3472126016"},{value:"S_0672575620",label:"S_0672575620"}]})},{label:"\u7279\u5E97\u7DE8\u865F",name:"specialStoreNo"},{label:"\u72C0\u614B",name:"status",className:"col-span-2",content:t(B,{className:"w-full",placeholder:"\u9078\u64C7\u72C0\u614B",options:[{value:"normal",label:"\u6B63\u5E38"},{value:"abnormal",label:"\u7570\u5E38"}]})},{label:"\u62DB\u652C\u6642\u9593",name:"\u62DB\u652C\u6642\u9593",content:t(he,{className:"w-full",format:w}),className:"col-span-4",initialValue:[_("2015/01/01",w),_("2015/01/01",w)]}],pe={_page:"1",_limit:"10"},Fe=()=>{const[n,o]=re(pe),{data:u,isLoading:s}=ue({queryKey:["store_list",{filterInfo:n}],keepPreviousData:!0,queryFn:()=>W(n)}),i=e=>{var m,p;const d=(m=e.current)==null?void 0:m.toString(),l=(p=e.pageSize)==null?void 0:p.toString();o({...n,_page:d,_limit:l})},r=e=>{const d={};for(const l in e)e[l]!==void 0&&l!=="\u62DB\u652C\u6642\u9593"&&(d[l]=e[l]);o({...n,...d})},a=e=>{var l;const d={...n};for(const m in e)e[m]===null?delete d[m]:d[m]=(l=e[m])==null?void 0:l.toString();o(d)};return t(k,{children:t(ie,{data:(u==null?void 0:u.data)||[],columns:de(),searchLayoutArray:Ce(),loading:s,rowClassName:e=>e.status!=="abnormal"?"":"bg-slate-300",templateTableProps:{width:100,align:"center"},onSearch:r,onPaginate:i,onSort:e=>console.log(e),onFilter:a,pagination:{position:["bottomCenter"],pageSize:parseInt((n==null?void 0:n._limit)||"10"),total:(u==null?void 0:u.total)||0,current:parseInt((n==null?void 0:n._page)||"1")}})})};export{Fe as default};
